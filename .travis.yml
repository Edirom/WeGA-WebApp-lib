sudo: required

language: java

services:
  - docker

before_install:
  - docker pull stadlerpeter/existdb
  - ant xar
  - curl http://exist-db.org/exist/apps/public-repo/public/functx-1.0.xar -o build/functx-1.0.xar
  - docker create --name exist stadlerpeter/existdb
  - for i in build/*.xar ; do docker cp $i exist:/opt/exist/autodeploy/ ; done
  - docker start exist
  - sleep 25
  - docker ps -a
  - echo "listing build dir"
  - ls -la build/
  - echo "listing autodeploy inside container"
  - docker exec -it exist ls -la autodeploy/

script: 
  - docker exec -it exist curl "http://127.0.0.1:8080/exist/apps/WeGA-WebApp-lib/testing/run-tests.xql" 